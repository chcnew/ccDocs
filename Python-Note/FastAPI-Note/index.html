
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="ä¸ªäººçŸ¥è¯†ç¬”è®°ä¸æŠ€æœ¯æ–‡æ¡£">
      
      
        <meta name="author" content="HC">
      
      
        <link rel="canonical" href="https://chcnew.github.io/ccDocs/Python-Note/FastAPI-Note/">
      
      
        <link rel="prev" href="../DRF-Note/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>FastAPI å…¥é—¨ - CCå­¦ä¹ æ–‡æ¡£åº“</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fastapi-uv-study" class="md-skip">
          è·³è½¬è‡³
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href="../.." title="CCå­¦ä¹ æ–‡æ¡£åº“" class="md-header__button md-logo" aria-label="CCå­¦ä¹ æ–‡æ¡£åº“" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CCå­¦ä¹ æ–‡æ¡£åº“
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              FastAPI å…¥é—¨
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">
        
        <button type="reset" class="md-search__icon md-icon" title="æ¸…ç©ºå½“å‰å†…å®¹" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  é¦–é¡µ

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Python-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" class="md-tabs__link">
          
  
  
  Python å­¦ä¹ ç¬”è®°

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  FastAPI ç³»åˆ—

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CCå­¦ä¹ æ–‡æ¡£åº“" class="md-nav__button md-logo" aria-label="CCå­¦ä¹ æ–‡æ¡£åº“" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CCå­¦ä¹ æ–‡æ¡£åº“
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    é¦–é¡µ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Python å­¦ä¹ ç¬”è®°
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Python å­¦ä¹ ç¬”è®°
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Python-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    å¹¶å‘ç¼–ç¨‹
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DRF-Note/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DRF æ¡†æ¶
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    FastAPI ç³»åˆ—
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            FastAPI ç³»åˆ—
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    FastAPI å…¥é—¨
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    FastAPI å…¥é—¨
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      1 FastAPIæ˜¯ä»€ä¹ˆï¼Ÿ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      2 FastAPIç‰¹ç‚¹
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-fastapidjangoflask" class="md-nav__link">
    <span class="md-ellipsis">
      3 FastAPIä¸Djangoã€FlaskåŒºåˆ«
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      4 FastAPIæŠ€æœ¯ç»„ä»¶æ¶æ„
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      5 ç›¸å…³æ–‡æ¡£å­¦ä¹ é“¾æ¥
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      6 FastAPIé¡¹ç›®å¼€å‘ç‰¹æ€§
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      1 FastAPIæ˜¯ä»€ä¹ˆï¼Ÿ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      2 FastAPIç‰¹ç‚¹
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-fastapidjangoflask" class="md-nav__link">
    <span class="md-ellipsis">
      3 FastAPIä¸Djangoã€FlaskåŒºåˆ«
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      4 FastAPIæŠ€æœ¯ç»„ä»¶æ¶æ„
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      5 ç›¸å…³æ–‡æ¡£å­¦ä¹ é“¾æ¥
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      6 FastAPIé¡¹ç›®å¼€å‘ç‰¹æ€§
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="fastapi-uv-study">FastAPI-uv-study</h1>
<p>ä¸ªäººå…¥é—¨å­¦ä¹ é¡¹ç›® -- å­¦ä¹ ç¬”è®° -- 2025</p>
<h2 id="1-fastapi">1 FastAPIæ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<ul>
<li>FastAPIæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ Web æ¡†æ¶ï¼Œç”¨äºæ„å»ºåŸºäº Python çš„ APIï¼›</li>
</ul>
<p>åŸºäºæ ‡å‡†çš„ Python ç±»å‹æç¤º(type hints) -- Pydanticï¼›</p>
<p>é€šè¿‡åˆ©ç”¨ Python çš„å¼‚æ­¥ç‰¹æ€§(å¦‚ asyncå’Œ await)ï¼Œæä¾›äº†æé«˜çš„æ€§èƒ½ -- Starletteï¼›</p>
<p>åŸºäº Uvicorn è¿è¡Œçš„ FastAP|ç¨‹åºæ˜¯ æˆªæ­¢2025å¹´ æœ€å¿«çš„ Python web æ¡†æ¶  -- è¿è¡Œå·¥å…·ã€‚</p>
<h2 id="2-fastapi">2 FastAPIç‰¹ç‚¹</h2>
<ul>
<li><strong>é«˜æ€§èƒ½</strong>ï¼šæ€§èƒ½æ¥è¿‘ Node.js å’Œ Golangï¼ŒåŸºäºå¼‚æ­¥ Web æœåŠ¡æ¡†æ¶ Starletteã€‚</li>
<li><strong>è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£</strong>ï¼šå¼€å‘æ¥å£ä¼šè‡ªåŠ¨ç”Ÿæˆäº¤äº’å¼æ–‡æ¡£ï¼Œä¾¿äºå¼€å‘è€…ç†è§£ä¸è°ƒè¯•APIã€‚</li>
<li><strong>æ”¯æŒç±»å‹æç¤º</strong>ï¼šå®Œå…¨é‡‡ç”¨Python3.6+æ”¯æŒçš„ç±»å‹æç¤ºï¼Œä»£ç æ›´ç®€æ´æ¸…æ™°ï¼Œæ”¯æŒè‡ªåŠ¨æ•°æ®éªŒè¯ä¸é”™è¯¯å¤„ç†ã€‚</li>
<li><strong>å¼‚æ­¥æ”¯æŒ</strong>ï¼šFastAPIåŸç”Ÿæ”¯æŒ ASGI åè®®ï¼Œå¾ˆæ–¹ä¾¿çš„ä½¿ç”¨ async/await è¯­æ³•å¼€å‘å¼‚æ­¥æ¥å£ï¼Œéå¸¸é€‚åˆå¤„ç† I/Oå¯†é›†å‹ ä»»åŠ¡ï¼Œå¦‚æ–‡ä»¶æ“ä½œã€æ•°æ®åº“æ“ä½œã€å¤–éƒ¨æ¥å£è°ƒç”¨ç­‰ã€‚</li>
<li><strong>å¼€å‘æ•ˆç‡é«˜</strong>ï¼šå€ŸåŠ© FastAPIï¼Œå¼€å‘è€…å¯ä»¥åœ¨æ›´çŸ­çš„æ—¶é—´å†…å¼€å‘å‡ºæ€§èƒ½ä¼˜ç§€ã€ç±»å‹å®‰å…¨çš„ APIã€‚å®ƒæä¾›äº†è®¸å¤šå†…ç½®å·¥å…·ï¼Œå¦‚æ•°æ®éªŒè¯ã€åºåˆ—åŒ–ã€ä¾èµ–æ³¨å…¥ç­‰ï¼Œå‡å°‘æ‰‹åŠ¨ç¼–å†™æ ·æ¿ä»£ç çš„éœ€æ±‚ã€‚</li>
<li><strong>æ•°æ®éªŒè¯å’Œåºåˆ—åŒ–</strong>ï¼šFastAPIä½¿ç”¨ Pydantic è¿›è¡Œæ•°æ®éªŒè¯å’Œåºåˆ—åŒ–ï¼Œè¿™ä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿè½»æ¾å®šä¹‰å’ŒéªŒè¯å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œç¡®ä¿ APIçš„è¾“å…¥è¾“å‡ºéƒ½ç¬¦åˆé¢„æœŸã€‚</li>
</ul>
<h2 id="3-fastapidjangoflask">3 FastAPIä¸Djangoã€FlaskåŒºåˆ«</h2>
<ul>
<li>FastAPI éå¸¸é€‚åˆæ­å»ºé«˜æ€§èƒ½çš„APIå¾®æœåŠ¡ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦å¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚æˆ–æ•°æ®éªŒè¯çš„åœºæ™¯ã€‚</li>
<li>Flask æ˜¯ä¸€ä¸ªè½»é‡çº§æ¡†æ¶ï¼Œé€‚ç”¨äºç®€å•åº”ç”¨æˆ–åŸå‹å¼€å‘ï¼Œå¤„ç†å¤æ‚çš„éœ€æ±‚æˆ–è®¸éœ€è¦é¢å¤–çš„é…ç½®ã€‚</li>
<li>Django æ˜¯ä¸€ä¸ªå…¨åŠŸèƒ½çš„æ¡†æ¶ï¼Œé€‚åˆæ„å»ºåŒ…å«æ•°æ®åº“ã€è®¤è¯ã€ç®¡ç†åå°çš„å¤æ‚åº”ç”¨ï¼›ä½†å¯¹äºçº¯APIé¡¹ç›®æ¥è¯´ï¼Œé€‰æ‹©è¯¥æ¡†æ¶ä¼šæ¯”è¾ƒç¬¨é‡ã€‚</li>
</ul>
<h2 id="4-fastapi">4 FastAPIæŠ€æœ¯ç»„ä»¶æ¶æ„</h2>
<p><img alt="image-20251029231204591" src="image-20251029231204591.png" /> </p>
<h2 id="5">5 ç›¸å…³æ–‡æ¡£å­¦ä¹ é“¾æ¥</h2>
<ul>
<li><strong>FastAPl</strong>ï¼šhttps://fastapi.tiangolo.com/zh/FastAPI</li>
</ul>
<p>æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„Web æ¡†æ¶ï¼ŒåŸºäºæ ‡å‡† Python ç±»å‹æç¤ºæ„å»º APIã€‚</p>
<ul>
<li><strong>Starlette</strong>ï¼šhttps://www.starlette.io/Starlette</li>
</ul>
<p>FastAP|æ˜¯æ„å»ºåœ¨ Starlette ä¹‹ä¸Šçš„ä¸€ä¸ª Web æ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ ASGIæ¡†æ¶/å·¥å…·åŒ…ï¼Œé€‚åˆç”¨ Python æ„å»ºå¼‚æ­¥ Web æœåŠ¡ï¼›</p>
<p>åœ¨FastAPIé¡¹ç›®å¼€å‘ä¸­ï¼Œç”šè‡³ä¼šå¼•å…¥Starletteçš„ä¸€äº›æ–¹æ³•æ¨¡å—ã€‚</p>
<ul>
<li><strong>Pydantic</strong>ï¼šhttps://docs.pydantic.dev/latest/Pydantic</li>
</ul>
<p>æ˜¯ Python ä½¿ç”¨æœ€å¹¿æ³›çš„æ•°æ®éªŒè¯ã€æ•°æ®è½¬æ¢åº“ã€‚</p>
<ul>
<li><strong>Tortoise</strong>ï¼šhttps://tortoise.github.io/index.html</li>
</ul>
<p>æ–‡æ¡£åœ°å€ï¼šhttps://tortoise.org.cn/index.html</p>
<p><strong>Tortoise ORM æ˜¯ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„å¼‚æ­¥ ORM(å¯¹è±¡å…³ç³»æ˜ å°„å™¨)</strong></p>
<p>SQLAlchemyä¹Ÿæ˜¯ä¸€ä¸ªåŠŸèƒ½éå¸¸å¼ºå¤§çš„ Python ORM æ¡†æ¶ä½†ä¸æ”¯æŒå¼‚æ­¥ã€‚</p>
<ul>
<li><strong>Jinja</strong>ï¼šhttps://jinja.palletsprojects.com/en/3.1.x/</li>
</ul>
<p>Jinja æ˜¯ä¸€ä¸ªå¿«é€Ÿã€å¯Œæœ‰è¡¨ç°åŠ›ã€å¯æ‰©å±•çš„æ¨¡æ¿å¼•æ“ï¼Œç”¨äºå¼€å‘å‰ç«¯é¡µé¢</p>
<ul>
<li><strong>Uvicorn</strong>ï¼šhttps://www.uvicorn.org/Uvicorn</li>
</ul>
<p>ä¸€ä¸ªåŸºäº ASGl(Asynchronous Server Gateway Interface)çš„é«˜æ€§èƒ½ã€è½»é‡çº§çš„ Python Web æœåŠ¡å™¨ã€‚</p>
<ul>
<li><strong>Docker</strong>ï¼š https://www.docker.com/</li>
</ul>
<p>Docker æ˜¯ç”¨äºéƒ¨ç½²å’Œè¿è¡Œåº”ç”¨ç¨‹åºã€‚å®ƒä½¿ç”¨å®¹å™¨æŠ€æœ¯æ¥æ‰“åŒ…åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–é¡¹ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºå¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒä¸‹ä¸€è‡´åœ°è¿è¡Œï¼Œæ— è®ºæ˜¯åœ¨å¼€å‘ã€æµ‹è¯•è¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒã€‚</p>
<ul>
<li><strong>uv</strong>ï¼šæ¨èä½¿ç”¨ <strong>uv</strong>  åˆ›å»ºç®¡ç†è™šæ‹Ÿç¯å¢ƒçš„ FastAPI å­¦ä¹ é¡¹ç›®</li>
</ul>
<p>uv æ˜¯ä¸€ä¸ªç°ä»£çš„pythonç¯å¢ƒç®¡ç†å™¨ï¼Œéå¸¸å¥½ç”¨ï¼Œä½¿ç”¨Rustè¯­è¨€å¼€å‘çš„ï¼Œé€Ÿåº¦å¾ˆå¿«</p>
<p>å®˜æ–¹åœ°å€ï¼šhttps://github.com/astral-sh/uv</p>
<p>ä¸­æ–‡æ–‡æ¡£ï¼šhttps://hellowac.github.io/uv-zh-cn/</p>
<ul>
<li>ç›¸å…³å¼€æºåå°ç®¡ç†ç³»ç»Ÿï¼š</li>
</ul>
<p>https://github.com/Richard0403/FluxPanel</p>
<h2 id="6-fastapi">6 FastAPIé¡¹ç›®å¼€å‘ç‰¹æ€§</h2>
<ul>
<li>
<p><strong>ç±»å‹å£°æ˜ç‰¹æ€§</strong>ï¼š</p>
</li>
<li>
<p>ä½¿ç”¨äº†å¤§é‡çš„Pythonç±»å‹å£°æ˜ï¼Œå³ä»fromtypingå¼•å…¥å¾ˆå¤šæ•°æ®ç±»å‹</p>
</li>
<li>
<p>å‡½æ•°çš„å…¥å‚éƒ½ä¼šå£°æ˜ç±»å‹ï¼Œæ–¹ä¾¿æ•°æ®ç±»å‹æ£€æŸ¥ã€ä¹Ÿæ–¹ä¾¿ä»£ç æç¤º</p>
</li>
<li>
<p><strong>æ•°æ®æ¨¡å‹ç±»ç‰¹æ€§</strong>ï¼š</p>
</li>
<li>
<p>å¤§é‡ä½¿ç”¨æ•°æ®æ¨¡å‹ç±»ï¼Œä¾‹å¦‚APIçš„å…¥å‚ã€å¤„ç†ã€è¿”å›ã€åˆ°æ•°æ®åº“çš„å­˜å‚¨</p>
</li>
<li>
<p>ä¾‹å¦‚å…¥å‚å’Œè¿”å›ï¼Œéƒ½é¢„å®šä¹‰ä¸€ä¸ªç±»ï¼Œè¡¨è¾¾æ•°æ®çš„æ¨¡å¼(æœ‰å“ªäº›å­—æ®µã€æ¯ä¸ªå­—æ®µçš„ç±»å‹)</p>
</li>
<li>
<p><strong>ä¾¿æ·æ”¯æŒå¼‚æ­¥ç¼–ç¨‹ç‰¹æ€§</strong>ï¼š</p>
</li>
<li>
<p>å¯¹äºæ•°æ®åº“ã€APIã€æ–‡ä»¶çš„è°ƒç”¨ï¼Œå¤§é‡ç»“åˆasyncå’Œawaitçš„å¼‚æ­¥ç¼–ç¨‹</p>
</li>
</ul>
<h1 id="uv">ä¸€ã€uvåˆ›å»ºé¡¹ç›®</h1>
<pre><code class="language-shell"># åˆ›å»ºé¡¹ç›®
uv init FastAPI-uv-study
cd FastAPI-uv-study

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
uv venv .venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
.venv\Scripts\activate

# é€€å‡ºè™šæ‹Ÿç¯å¢ƒ
.venv\Scripts\deactivate

# ##### uv å¯ä»¥æŒ‡å®šå·²å®‰è£…åœ¨ç³»ç»Ÿpythonç‰ˆæœ¬ ##### 

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶ä½¿ç”¨æŒ‡å®š Python
uv python list                     # çœ‹æœ‰å“ªäº› Python
uv venv .venv --python=3.10        # ç”¨æŒ‡å®šç‰ˆæœ¬åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
.venv\Scripts\activate             # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
</code></pre>
<h2 id="1">1 å®‰è£…ä¾èµ–</h2>
<p>æ–°é¡¹ç›®å»ºè®®ä½¿ç”¨ï¼šuv add xxx</p>
<p>ä»¥å‰ pip ç®¡ç†çš„æ—§é¡¹ç›®ï¼šuv add install xxx</p>
<p>è¿™é‡ŒæŒ‰æ–°é¡¹ç›®æ–¹å¼ï¼š</p>
<pre><code class="language-shell">uv add fastapi &quot;uvicorn[standard]&quot;
uv add pytest --dev

# --dev å‚æ•°ï¼šè¡¨ç¤ºåªç”¨äºå¼€å‘ç¯å¢ƒçš„ä¾èµ–ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒå®‰è£…å¤šä½™ä¾èµ–

# ç”Ÿäº§ç¯å¢ƒåŒæ­¥å®‰è£…ä¾èµ–å‘½ä»¤
uv sync
uv sync --dev # å¦‚æœæœ‰å¿…è¦åœ¨ç”Ÿäº§ä¹Ÿå®‰è£…å¼€å‘ç¯å¢ƒç›¸å…³ä¾èµ–ï¼Œåˆ™ä½¿ç”¨è¯¥å‘½ä»¤

# åˆ é™¤ä¾èµ–
uv remove &lt;åŒ…å&gt;
</code></pre>
<h2 id="2-pyprojecttoml">2 æŸ¥çœ‹é¡¹ç›®å£°æ˜çš„ä¾èµ–ï¼ˆpyproject.toml ï¼‰</h2>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>uv tree</code></td>
<td>ä»¥ä¾èµ–æ ‘å½¢å¼æ˜¾ç¤ºé¡¹ç›®å®‰è£…çš„æ‰€æœ‰åŒ…ï¼ˆç”Ÿäº§ + å¼€å‘ï¼‰</td>
</tr>
<tr>
<td><code>uv tree --dev</code></td>
<td>ä»…æŸ¥çœ‹å¼€å‘ä¾èµ–</td>
</tr>
<tr>
<td><code>uv export</code></td>
<td>å¯¼å‡ºæ‰€æœ‰ä¾èµ–åˆ° <code>requirements.txt</code> å½¢å¼</td>
</tr>
<tr>
<td><code>uv export --dev</code></td>
<td>åŒ…å«å¼€å‘ä¾èµ–ä¸€èµ·å¯¼å‡º</td>
</tr>
</tbody>
</table>
<h1 id="fastapi-">äºŒã€FastAPI-é¡¹ç›®ç»“æ„</h1>
<pre><code class="language-shell">FastAPI-uv-study/
â”œâ”€â”€ main.py                    # åº”ç”¨å…¥å£
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ v1/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â””â”€â”€ items.py       # æ¨¡å—åŒ–è·¯ç”±
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â””â”€â”€ config.py          # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â””â”€â”€ database.py        # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ models/                # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ schemas/               # Pydantic æ¨¡å‹
â””â”€â”€ requirements.txt
</code></pre>
<h1 id="_1">ä¸‰ã€æ¨¡å—åŒ–å¼€å‘ç¤ºä¾‹</h1>
<h2 id="1-mainpy">1 main.py</h2>
<pre><code class="language-python"># _*_ coding: utf-8 _*_

&quot;&quot;&quot;
æœåŠ¡å¯åŠ¨å‘½ä»¤ï¼šuvicorn main:app --reload
&quot;&quot;&quot;
import uvicorn  # noqa
from fastapi import FastAPI

from app.api.v1 import index, project, version
from app.core.config import settings
from app.core.http_client import lifespan


def create_app() -&gt; FastAPI:
    &quot;&quot;&quot;
    åˆ›å»º FastAPI åº”ç”¨å®ä¾‹
    &quot;&quot;&quot;
    app = FastAPI(
        title=settings.PROJECT_NAME,
        version=&quot;1.0.0&quot;,
        description=&quot;FastAPI æ¨¡å—åŒ–é¡¹ç›®ç¤ºä¾‹&quot;,
        lifespan=lifespan
    )

    # æ³¨å†Œè·¯ç”± -è·¯ç”±ç»„é…ç½®
    routers = {
        &quot;/home&quot;: [
            (index.router, {&quot;tags&quot;: [&quot;é¦–é¡µ&quot;]})
        ],
        &quot;/api/v1&quot;: [
            (project.router, {&quot;tags&quot;: [&quot;é¡¹ç›®ç®¡ç†&quot;]}),
            (version.router, {&quot;tags&quot;: [&quot;ç‰ˆæœ¬ç®¡ç†&quot;]}),
        ],
        # &quot;/api/v2&quot;:[]
    }
    for prefix, config in routers.items():
        for router, tags in config:
            app.include_router(router, prefix=prefix, tags=tags)

    return app


app = create_app()

if __name__ == '__main__':
    print(&quot;æ–‡æ¡£åœ°å€ï¼šhttp://127.0.0.1:8000/docs&quot;)
    print(&quot;é¦–é¡µåœ°å€ï¼šhttp://127.0.0.1:8000/home/index/&quot;)
    uvicorn.run(&quot;main:app&quot;, host=&quot;0.0.0.0&quot;, port=8000, reload=True)
</code></pre>
<h2 id="2-appcoreconfigpy">2 app/core/config.py</h2>
<pre><code class="language-python"># _*_ coding: utf-8 _*_
from pydantic import BaseConfig


class Settings(BaseConfig):
    PROJECT_NAME: str = &quot;FastAPI-uv-study&quot;
    DEBUG: bool = True
    DATABASE_URL: str = &quot;sqlite:///./test.db&quot;

    # class Config:
    #     env_file = &quot;.env&quot;  # æ”¯æŒä» .env æ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡


settings = Settings()

</code></pre>
<h2 id="3-appcorehttp_clientpy">3 app/core/http_client.py</h2>
<pre><code class="language-python"># _*_ coding: utf-8 _*_

&quot;&quot;&quot;
å¼‚æ­¥è¯·æ±‚å®¢æˆ·ç«¯

asynccontextmanagerï¼š
    åç§°ï¼šå¼‚æ­¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨
    è¢«è£…é¥°å‡½æ•°ä¸­ yieldï¼šåˆ†å‰²è¿›å…¥ä¸é€€å‡ºçš„æ“ä½œ
&quot;&quot;&quot;
from contextlib import asynccontextmanager

import aiohttp
from fastapi import FastAPI


# å…¨å±€ session ç®¡ç†
class HTTPClient:
    def __init__(self):
        self.session = None

    async def start(self):
        self.session = aiohttp.ClientSession()

    async def close(self):
        if self.session:
            await self.session.close()


http_client = HTTPClient()


@asynccontextmanager
async def lifespan(app: FastAPI):
    # å¯åŠ¨æ—¶åˆ›å»º session
    print(f&quot;Starting application: {app.title}&quot;)
    await http_client.start()
    yield
    # å…³é—­æ—¶æ¸…ç† session
    print(f&quot;Shutting down application: {app.title}&quot;)
    await http_client.close()

</code></pre>
<h2 id="4-appapiv1indexpy">4 app/api/v1/index.py</h2>
<pre><code class="language-python"># _*_ coding: utf-8 _*_
from fastapi import APIRouter

router = APIRouter(prefix=&quot;/index&quot;)


@router.get(&quot;/&quot;)
def index():
    return {&quot;message&quot;: &quot;This is Index page&quot;}

</code></pre>
<h2 id="5-appapiv1projectpy">5 app/api/v1/project.py</h2>
<pre><code class="language-python"># _*_ coding: utf-8 _*_
import asyncio

import aiohttp
from fastapi import APIRouter
from fastapi import HTTPException

from app.core.http_client import http_client

router = APIRouter(prefix=&quot;/project&quot;)


@router.get(&quot;/&quot;)
async def get_projects(platform: str):
    &quot;&quot;&quot;
    è·å–é¡¹ç›®åˆ—è¡¨

    Args:
     platform (str): å¹³å°åç§°ï¼›ç¤ºä¾‹ï¼šMTK6993

    Returns:
     dict: åŒ…å«é¡¹ç›®åˆ—è¡¨çš„å­—å…¸ï¼›ç¤ºä¾‹ï¼š{&quot;projects&quot;: [p1, p2, p3...]}
    &quot;&quot;&quot;
    try:
        # å¤ç”¨å…¨å±€ sessionï¼Œé¿å…æ¯æ¬¡åˆ›å»º
        async with http_client.session.get(
                f&quot;http://172.16.191.214:9777/api/get-projects-and-versions?platform={platform}&quot;,
                timeout=aiohttp.ClientTimeout(total=10)  # æ·»åŠ è¶…æ—¶
        ) as resp:
            if resp.status == 200:
                json_dict = await resp.json()
                await asyncio.sleep(3)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
                return {&quot;projects&quot;: json_dict['projects']}
            else:
                raise HTTPException(status_code=resp.status, detail=f&quot;ä¸Šæ¸¸æœåŠ¡é”™è¯¯: {resp.status}&quot;)

    except asyncio.TimeoutError:
        raise HTTPException(status_code=504, detail=&quot;è¯·æ±‚è¶…æ—¶&quot;)
    except Exception as e:
        raise HTTPException(status_code=500, detail=f&quot;æœåŠ¡å†…éƒ¨é”™è¯¯: {str(e)}&quot;)

</code></pre>
<h2 id="6-appapiv1versionpy">6 app/api/v1/version.py</h2>
<pre><code class="language-python"># _*_ coding: utf-8 _*_
# _*_ coding: utf-8 _*_
import asyncio

import aiohttp
from fastapi import APIRouter
from fastapi import HTTPException

from app.core.http_client import http_client

router = APIRouter(prefix=&quot;/version&quot;)


@router.get(&quot;/&quot;)
async def get_versions(platform: str):
    &quot;&quot;&quot;
    è·å–é¡¹ç›®åˆ—è¡¨

    Args:
     platform (str): å¹³å°åç§°ï¼›ç¤ºä¾‹ï¼šMTK6993

    Returns:
     dict: åŒ…å«ç‰ˆæœ¬åˆ—è¡¨çš„å­—å…¸ï¼›ç¤ºä¾‹ï¼š{&quot;versions&quot;: [p1, p2, p3...]}
    &quot;&quot;&quot;
    try:
        # å¤ç”¨å…¨å±€ sessionï¼Œé¿å…æ¯æ¬¡åˆ›å»º
        async with http_client.session.get(
                f&quot;http://172.16.191.214:9777/api/get-projects-and-versions?platform={platform}&quot;,
                timeout=aiohttp.ClientTimeout(total=10)  # æ·»åŠ è¶…æ—¶
        ) as resp:
            if resp.status == 200:
                json_dict = await resp.json()
                await asyncio.sleep(3)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
                return {&quot;versions&quot;: json_dict['versions']}
            else:
                raise HTTPException(status_code=resp.status, detail=f&quot;ä¸Šæ¸¸æœåŠ¡é”™è¯¯: {resp.status}&quot;)

    except asyncio.TimeoutError:
        raise HTTPException(status_code=504, detail=&quot;è¯·æ±‚è¶…æ—¶&quot;)
    except Exception as e:
        raise HTTPException(status_code=500, detail=f&quot;æœåŠ¡å†…éƒ¨é”™è¯¯: {str(e)}&quot;)

</code></pre>
<h1 id="_2">å››ã€ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶</h1>
<h2 id="1-starlette-asgi">1 Starlette - ASGI æ¡†æ¶</h2>
<p><strong>Starlette</strong> æ˜¯ä¸€ä¸ª <strong>è½»é‡çº§ã€é«˜æ€§èƒ½çš„ Python å¼‚æ­¥ Web æ¡†æ¶ / ASGI æ¡†æ¶ï¼Œæä¾›åº•å±‚ Web èƒ½åŠ›ï¼ˆè·¯ç”±ã€è¯·æ±‚ã€å“åº”ã€ä¸­é—´ä»¶ç­‰ï¼‰ã€‚</strong></p>
<p><strong>FastAPI</strong> å’Œ <a href="https://www.starlette.dev/"><strong>Starlette</strong></a> å®Œå…¨å…¼å®¹(å¹¶åŸºäº)ã€‚æ‰€ä»¥ï¼Œä½ æœ‰çš„å…¶ä»–çš„ Starlette ä»£ç ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚<code>FastAPI</code> å®é™…ä¸Šæ˜¯ <code>Starlette</code>çš„ä¸€ä¸ªå­ç±»ã€‚</p>
<pre><code class="language-markdown">      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚          FastAPI             â”‚  â† æä¾›ç±»å‹æ ¡éªŒã€ä¾èµ–æ³¨å…¥ã€OpenAPIã€è‡ªåŠ¨æ–‡æ¡£
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ ç»§æ‰¿
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚          Starlette           â”‚  â† æä¾› ASGIã€è·¯ç”±ã€ä¸­é—´ä»¶ã€è¯·æ±‚/å“åº” ç­‰åŸºç¡€åŠŸèƒ½
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚            ASGI              â”‚  â† å¼‚æ­¥æ¥å£æ ‡å‡† (ç±»ä¼¼äº Flask çš„ WSGI)
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>é€šè¿‡ <strong>FastAPI</strong> ä½ å¯ä»¥è·å¾—æ‰€æœ‰ <strong>Starlette</strong> çš„ç‰¹æ€§ ( FastAPI å°±åƒåŠ å¼ºç‰ˆçš„ Starlette )ï¼š</p>
<ul>
<li>ä»¤äººæƒŠå¹çš„æ€§èƒ½ã€‚å®ƒæ˜¯ <a href="https://github.com/encode/starlette#performance">Python å¯ç”¨çš„æœ€å¿«çš„æ¡†æ¶ä¹‹ä¸€ï¼Œå’Œ <strong>NodeJS</strong> åŠ <strong>Go</strong> ç›¸å½“</a>ã€‚</li>
<li><strong>æ”¯æŒ WebSocket</strong> ã€‚</li>
<li><strong>æ”¯æŒ GraphQL</strong> ã€‚</li>
<li>åå°ä»»åŠ¡å¤„ç†ã€‚</li>
<li>Startup å’Œ shutdown äº‹ä»¶ã€‚</li>
<li>æµ‹è¯•å®¢æˆ·ç«¯åŸºäº HTTPXã€‚</li>
<li><strong>CORS</strong>, GZip, é™æ€æ–‡ä»¶, æµå“åº”ã€‚</li>
<li>æ”¯æŒ <strong>Session å’Œ Cookie</strong> ã€‚</li>
<li>100% æµ‹è¯•è¦†ç›–ç‡ã€‚</li>
<li>ä»£ç åº“ 100% ç±»å‹æ³¨é‡Šã€‚</li>
</ul>
<h2 id="2-pydantic-">2 Pydantic - æ•°æ®éªŒè¯ä¸è§£æåº“</h2>
<p><strong>Pydantic</strong> æ˜¯ä¸€ä¸ªåŸºäº Python <strong>ç±»å‹æ³¨è§£ï¼ˆType Hintsï¼‰</strong> çš„ <strong>æ•°æ®éªŒè¯ä¸è§£æåº“</strong>ã€‚</p>
<p><strong>Pydanticç†å¿µ</strong>ï¼šâ€œä½¿ç”¨æ ‡å‡†çš„ Python ç±»å‹æ³¨è§£ï¼ˆtypingï¼‰ï¼Œè‡ªåŠ¨å®Œæˆæ•°æ®éªŒè¯ã€ç±»å‹è½¬æ¢å’Œé”™è¯¯æç¤ºã€‚â€</p>
<table>
<thead>
<tr>
<th>åŠŸèƒ½</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>âœ… ç±»å‹éªŒè¯</td>
<td>è‡ªåŠ¨æ£€æŸ¥è¾“å…¥æ•°æ®ç±»å‹</td>
</tr>
<tr>
<td>ğŸ”„ ç±»å‹è½¬æ¢</td>
<td>è‡ªåŠ¨å°†å­—ç¬¦ä¸²ã€æ•°å­—ç­‰è½¬æˆç›®æ ‡ç±»å‹</td>
</tr>
<tr>
<td>ğŸš¨ é”™è¯¯æç¤º</td>
<td>éªŒè¯å¤±è´¥æ—¶è¿”å›ç»“æ„åŒ–é”™è¯¯ä¿¡æ¯</td>
</tr>
<tr>
<td>ğŸ§± é»˜è®¤å€¼</td>
<td>æ”¯æŒå­—æ®µé»˜è®¤å€¼</td>
</tr>
<tr>
<td>ğŸ§¾ JSON åºåˆ—åŒ–</td>
<td>æ”¯æŒ <code>.json()</code> å¯¼å‡º</td>
</tr>
<tr>
<td>ğŸ§  åµŒå¥—æ¨¡å‹</td>
<td>æ”¯æŒå¤æ‚åµŒå¥—ç»“æ„</td>
</tr>
<tr>
<td>ğŸ” æ ¡éªŒè§„åˆ™</td>
<td>æ”¯æŒæ­£åˆ™ã€èŒƒå›´ã€é•¿åº¦ç­‰éªŒè¯</td>
</tr>
</tbody>
</table>
<p><strong>Pydantic ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="language-python"># _*_ coding: utf-8 _*_

&quot;&quot;&quot;
åŠŸèƒ½ï¼šæ¼”ç¤ºä½¿ç”¨pydantic
&quot;&quot;&quot;
from datetime import datetime
from typing import List, Optional

from pydantic import BaseModel


class User(BaseModel):
    id: int
    name: str = 'chc'  # ä¹Ÿå¯ä»¥è®¾ç½®å¸¸é‡
    age: int
    hobby: List[int] = []
    signup_time: Optional[datetime] = None


external_data = {
    'id': '1',
    'age': '23',
    'hobby': ['1', '2', 99],
    'signup_time': '2019-12-23 23:59:59',
}

user = User(**external_data)
print(user.model_dump())

# è¾“å‡ºç»“æœ-è‡ªåŠ¨è½¬åŒ–
# {'id': 1, 'name': 'chc', 'age': 23, 'hobby': [1, 2, 99], 'signup_time': datetime.datetime(2019, 12, 23, 23, 59, 59)}
</code></pre>
<h2 id="3">3 æ€»ç»“</h2>
<table>
<thead>
<tr>
<th>ç»„ä»¶</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Starlette</strong></td>
<td>æä¾› ASGI å±‚ã€è·¯ç”±ã€ä¸­é—´ä»¶ã€HTTP/WebSocket åŸºç¡€</td>
</tr>
<tr>
<td><strong>Pydantic</strong></td>
<td>æä¾›æ•°æ®æ¨¡å‹ã€ç±»å‹éªŒè¯ã€åºåˆ—åŒ–</td>
</tr>
<tr>
<td><strong>FastAPI</strong></td>
<td>æŠŠä¸¤è€…ç»“åˆ + è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ + ä¾èµ–æ³¨å…¥æœºåˆ¶</td>
</tr>
</tbody>
</table>
<p>ä¸‰è€…çš„å…³ç³»å¦‚ä¸‹ï¼š</p>
<pre><code class="language-markdown">       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   Pydantic    â”‚  â† æ•°æ®éªŒè¯/Schema
       â””â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        FastAPI            â”‚  â† ä¸»æ¡†æ¶ (å°è£… + æ–‡æ¡£ + ä¾èµ–æ³¨å…¥)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
       â”‚  Starlette   â”‚  â† åº•å±‚ ASGI æ¡†æ¶
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Starlette</strong> ä¸ <strong>FastAPI</strong> å¯¹æ¯”ï¼š</p>
<table>
<thead>
<tr>
<th>å¯¹æ¯”é¡¹</th>
<th><strong>Starlette</strong></th>
<th><strong>FastAPI</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>å®šä½</td>
<td>åº•å±‚ ASGI æ¡†æ¶</td>
<td>é«˜çº§ Web æ¡†æ¶</td>
</tr>
<tr>
<td>ç‰¹ç‚¹</td>
<td>è½»é‡ã€çµæ´»ã€æ— ç±»å‹ç³»ç»Ÿ</td>
<td>è‡ªåŠ¨æ ¡éªŒã€è‡ªåŠ¨æ–‡æ¡£</td>
</tr>
<tr>
<td>å‚æ•°éªŒè¯</td>
<td>æ‰‹åŠ¨</td>
<td>è‡ªåŠ¨ï¼ˆåŸºäºç±»å‹æç¤º + Pydanticï¼‰</td>
</tr>
<tr>
<td>æ–‡æ¡£ç”Ÿæˆ</td>
<td>æ— </td>
<td>è‡ªåŠ¨ç”Ÿæˆ Swagger / ReDoc</td>
</tr>
<tr>
<td>å­¦ä¹ éš¾åº¦</td>
<td>ç¨ä½å±‚</td>
<td>é«˜å±‚å°è£…æ›´å‹å¥½</td>
</tr>
<tr>
<td>æ¨èç”¨é€”</td>
<td>è‡ªå®šä¹‰å¾®æ¡†æ¶ã€ä¸­é—´ä»¶ã€å·¥å…·</td>
<td>RESTful APIã€å¾®æœåŠ¡</td>
</tr>
</tbody>
</table>
<p>ä¸€å¥è¯è®°å¿†ï¼š<strong>FastAPI = Starlette + Pydantic + è‡ªåŠ¨æ–‡æ¡£ + ä¾èµ–æ³¨å…¥</strong></p>
<h1 id="http">äº”ã€httpåè®®</h1>
<p><img alt="image-20251027231257400" src="image-20251027231257400.png" /> </p>
<p><strong>åè®®è§„èŒƒè¯·æ±‚æ ¼å¼</strong>ï¼šåè®®://ä¸»æœº:ç«¯å£ + è·¯å¾„ + å‚æ•° + å°è£…å‚æ•°(å¦‚ï¼šè¯·æ±‚å¤´)</p>
<h1 id="_3">å…­ã€å¼€å‘æ¨¡å¼</h1>
<h2 id="1_1">1 å‰åç«¯ä¸åˆ†ç¦»</h2>
<p><img alt="depended_frontend_backend" src="depended_frontend_backend.png" /> </p>
<h2 id="2">2 å‰åç«¯åˆ†ç¦»</h2>
<p><img alt="indepent_frontend_backend-16318493319127" src="indepent_frontend_backend-16318493319127.png" /> </p>
<h1 id="api">ä¸ƒã€APIæ¥å£æ¦‚å¿µ</h1>
<p>åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ˆApplication Programming Interfaceï¼ŒAPIæ¥å£ï¼‰ï¼Œå°±æ˜¯åº”ç”¨ç¨‹åºå¯¹å¤–æä¾›äº†ä¸€ä¸ªæ“ä½œæ•°æ®çš„å…¥å£ï¼Œè¿™ä¸ªå…¥å£å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°æˆ–ç±»æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªurlåœ°å€æˆ–è€…ä¸€ä¸ªç½‘ç»œåœ°å€ã€‚å½“å®¢æˆ·ç«¯è°ƒç”¨è¿™ä¸ªå…¥å£ï¼Œåº”ç”¨ç¨‹åºåˆ™ä¼šæ‰§è¡Œå¯¹åº”ä»£ç æ“ä½œï¼Œç»™å®¢æˆ·ç«¯å®Œæˆç›¸å¯¹åº”çš„åŠŸèƒ½ã€‚</p>
<p>å½“ç„¶ï¼Œapiæ¥å£åœ¨å·¥ä½œä¸­æ˜¯æ¯”è¾ƒå¸¸è§çš„å¼€å‘å†…å®¹ï¼Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨å…¶ä»–äººç¼–å†™çš„apiæ¥å£ï¼Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æä¾›apiæ¥å£ç»™å…¶ä»–äººæ“ä½œã€‚ç”±æ­¤å°±ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œapiæ¥å£å¾€å¾€éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€ç±»æ–¹æ³•ã€æˆ–è€…urlæˆ–å…¶ä»–ç½‘ç»œåœ°å€ï¼Œä¸æ–­æ˜¯å“ªä¸€ç§ï¼Œå½“apiæ¥å£ç¼–å†™è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éƒ½è¦è€ƒè™‘ä¸€ä¸ªé—®é¢˜å°±æ˜¯è¿™ä¸ªæ¥å£åº”è¯¥æ€ä¹ˆç¼–å†™ï¼Ÿæ¥å£æ€ä¹ˆå†™çš„æ›´åŠ å®¹æ˜“ç»´æŠ¤å’Œæ¸…æ™°ï¼Œè¿™å°±éœ€è¦å¤§å®¶åœ¨è°ƒç”¨æˆ–è€…ç¼–å†™apiæ¥å£çš„æ—¶å€™è¦æœ‰ä¸€ä¸ªæ˜ç¡®çš„ç¼–å†™è§„èŒƒï¼ï¼ï¼</p>
<p>ä¸ºäº†åœ¨å›¢é˜Ÿå†…éƒ¨å½¢æˆå…±è¯†ã€é˜²æ­¢ä¸ªäººä¹ æƒ¯å·®å¼‚å¼•èµ·çš„æ··ä¹±ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æ‰¾åˆ°ä¸€ç§å¤§å®¶éƒ½è§‰å¾—å¾ˆå¥½çš„æ¥å£å®ç°è§„èŒƒï¼Œè€Œä¸”è¿™ç§è§„èŒƒèƒ½å¤Ÿè®©åç«¯å†™çš„æ¥å£ï¼Œç”¨é€”ä¸€ç›®äº†ç„¶ï¼Œå‡å°‘å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åŒæ–¹ä¹‹é—´çš„åˆä½œæˆæœ¬ã€‚</p>
<p>ç›®å‰å¸‚é¢ä¸Šå¤§éƒ¨åˆ†å…¬å¸å¼€å‘äººå‘˜ä½¿ç”¨çš„<strong>æ¥å£å®ç°è§„èŒƒä¸»è¦æœ‰ï¼šRPCã€restfulã€‚</strong></p>
<h2 id="1-rpc-remote-procedure-call">1 RPCï¼ˆ Remote Procedure Call ï¼‰</h2>
<p>â€‹   ç¿»è¯‘æˆä¸­æ–‡ï¼š<strong>è¿œç¨‹è¿‡ç¨‹è°ƒç”¨[è¿œç¨‹æœåŠ¡è°ƒç”¨</strong>ã€‚ä»å­—é¢ä¸Šç†è§£å°±æ˜¯è®¿é—®/è°ƒç”¨è¿œç¨‹æœåŠ¡ç«¯æä¾›çš„apiæ¥å£ã€‚è¿™ç§æ¥å£ä¸€èˆ¬ä»¥æœåŠ¡æˆ–è€…è¿‡ç¨‹å¼ä»£ç æä¾›ã€‚</p>
<ul>
<li>
<p>æœåŠ¡ç«¯æä¾›ä¸€ä¸ª<strong>å”¯ä¸€çš„è®¿é—®å…¥å£åœ°å€</strong>ï¼šhttp://api.xxx.com/ æˆ– http://www.xx.com/api æˆ–è€…åŸºäºå…¶ä»–åè®®çš„åœ°å€</p>
</li>
<li>
<p>å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡ç«¯çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½ç†è§£ä¸ºåŠ¨ä½œ(action)ï¼Œä¸€èˆ¬webå¼€å‘æ—¶ï¼Œå¯¹åº”çš„å°±æ˜¯HTTPè¯·æ±‚çš„postè¯·æ±‚</p>
</li>
<li>
<p>é€šè¿‡<strong>è¯·æ±‚ä½“</strong>å‚æ•°ï¼ŒæŒ‡å®šè¦è°ƒç”¨çš„æ¥å£åç§°å’Œæ¥å£æ‰€éœ€çš„å‚æ•°</p>
</li>
</ul>
<p>action=get_all_student&amp;class=301&amp;sex=1</p>
<p>m=get_all_student&amp;sex=1&amp;age=22</p>
<p>command=100&amp;sex=1&amp;age=22</p>
<p>RPCæ¥å£å¤šäº†,å¯¹åº”å‡½æ•°åå’Œå‚æ•°å°±å¤šäº†,å‰ç«¯åœ¨è¯·æ±‚apiæ¥å£æ—¶éš¾æ‰¾ï¼Œå¯¹äºå¹´ä»£ä¹…è¿œçš„rpcæœåŠ¡ç«¯çš„ä»£ç ä¹Ÿå®¹æ˜“å‡ºç°é‡å¤çš„æ¥å£</p>
<h2 id="2-restful">2 Restful</h2>
<p>â€‹   ç¿»è¯‘æˆä¸­æ–‡ï¼š<strong>èµ„æºçŠ¶æ€è½¬æ¢.(è¡¨å¾æ€§çŠ¶æ€è½¬ç§»)</strong></p>
<ul>
<li>æŠŠæœåŠ¡ç«¯æä¾›çš„æ‰€æœ‰çš„æ•°æ®/æ–‡ä»¶éƒ½çœ‹æˆèµ„æºï¼Œ é‚£ä¹ˆé€šè¿‡apiæ¥å£è¯·æ±‚æ•°æ®çš„æ“ä½œï¼Œæœ¬è´¨ä¸Šæ¥è¯´å°±æ˜¯å¯¹èµ„æºçš„æ“ä½œäº†.</li>
</ul>
<p>å› æ­¤ï¼Œrestfulä¸­è¦æ±‚ï¼Œæˆ‘ä»¬æŠŠå½“å‰æ¥å£å¯¹å¤–æä¾›å“ªç§èµ„æºè¿›è¡Œæ“ä½œï¼Œå°±æŠŠ<strong>èµ„æºçš„åç§°å†™åœ¨urlåœ°å€</strong>ã€‚</p>
<ul>
<li>webå¼€å‘ä¸­æ“ä½œèµ„æºï¼Œæœ€å¸¸è§çš„æœ€é€šç”¨çš„æ— éå°±æ˜¯å¢åˆ æŸ¥æ”¹ï¼Œæ‰€ä»¥restfulè¦æ±‚åœ¨åœ°å€æ ä¸­å£°æ˜è¦æ“ä½œçš„èµ„æºæ˜¯ä»€ä¹ˆã€‚ç„¶åé€šè¿‡<strong>httpè¯·æ±‚åŠ¨è¯</strong>æ¥è¯´æ˜å¯¹è¯¥èµ„æºè¿›è¡Œå“ªä¸€ç§æ“ä½œ</li>
</ul>
<blockquote>
<p>POST http://www.xxx.com/api/students/   â€”&gt;  æ·»åŠ å­¦ç”Ÿæ•°æ®</p>
<p>GET http://www.xxx.com/api/students/   â€”&gt;  è·å–æ‰€æœ‰å­¦ç”Ÿ</p>
<p>GET http://www.xxx.com/api/students/<pk>/   â€”&gt;  è·å–id=pkçš„å­¦ç”Ÿ</p>
<p>DELETE http://www.xxx.com/api/students/<pk>/   â€”&gt;  åˆ é™¤id=pkçš„ä¸€ä¸ªå­¦ç”Ÿ</p>
<p>PUT http://www.xxx.com/api/students/<pk>/   â€”&gt;  ä¿®æ”¹ä¸€ä¸ªå­¦ç”Ÿçš„å…¨éƒ¨ä¿¡æ¯ [id,name,sex,age,]</p>
<p>PATCH http://www.xxx.com/api/students/<pk>/   â€”&gt;  ä¿®æ”¹ä¸€ä¸ªå­¦ç”Ÿçš„éƒ¨åˆ†ä¿¡æ¯[age]</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä»…éœ€è¦é€šè¿‡urlåœ°å€ä¸Šçš„èµ„æºåç§°ç»“åˆHTTPè¯·æ±‚åŠ¨ä½œï¼Œå°±å¯ä»¥è¯´æ˜å½“å‰apiæ¥å£çš„åŠŸèƒ½æ˜¯ä»€ä¹ˆäº†ã€‚</p>
<p>RPCåŠ¨ä½œä¸ºä¸»çš„apiæ¥å£è§„èŒƒï¼Œä½“ç°åœ¨æ¥å£åç§°ä¸Šå¾€å¾€é™„å¸¦æ“ä½œæ•°æ®çš„åŠ¨ä½œã€‚</p>
<p>Restfulæ˜¯ä»¥èµ„æºä¸ºä¸»çš„apiæ¥å£è§„èŒƒï¼Œä½“ç°åœ¨åœ°å€ä¸Šå°±æ˜¯èµ„æºå°±æ˜¯ä»¥åè¯è¡¨è¾¾ã€‚</p>
<p>æ€»ç»“æ¦‚æ‹¬ï¼šå¢åˆ æ”¹æŸ¥æŸ¥</p>
<h2 id="3-restful-api">3 RESTful APIè§„èŒƒ</h2>
<p><img alt="restful" src="restful.gif" /> </p>
<p>RESTå…¨ç§°æ˜¯Representational State Transferï¼Œä¸­æ–‡æ„æ€æ˜¯è¡¨è¿°ï¼ˆç¼–è€…æ³¨ï¼šé€šå¸¸è¯‘ä¸ºè¡¨å¾ï¼‰æ€§çŠ¶æ€è½¬ç§»ã€‚ å®ƒé¦–æ¬¡å‡ºç°åœ¨2000å¹´Roy Fieldingçš„åšå£«è®ºæ–‡ä¸­ã€‚</p>
<p>RESTfulæ˜¯ä¸€ç§ä¸“é—¨ä¸ºWeb å¼€å‘è€Œå®šä¹‰APIæ¥å£çš„è®¾è®¡é£æ ¼ï¼Œå°¤å…¶é€‚ç”¨äºå‰åç«¯åˆ†ç¦»çš„åº”ç”¨æ¨¡å¼ä¸­ã€‚</p>
<p>è¿™ç§é£æ ¼çš„ç†å¿µè®¤ä¸ºåç«¯å¼€å‘ä»»åŠ¡å°±æ˜¯æä¾›æ•°æ®çš„ï¼Œå¯¹å¤–æä¾›çš„æ˜¯æ•°æ®èµ„æºçš„è®¿é—®æ¥å£ï¼Œæ‰€ä»¥åœ¨å®šä¹‰æ¥å£æ—¶ï¼Œå®¢æˆ·ç«¯è®¿é—®çš„URLè·¯å¾„å°±è¡¨ç¤ºè¿™ç§è¦æ“ä½œçš„æ•°æ®èµ„æºã€‚</p>
<p>è€Œå¯¹äºæ•°æ®èµ„æºåˆ†åˆ«ä½¿ç”¨POSTã€DELETEã€GETã€UPDATEç­‰è¯·æ±‚åŠ¨ä½œæ¥è¡¨è¾¾å¯¹æ•°æ®çš„å¢åˆ æŸ¥æ”¹ã€‚</p>
<h3 id="31-restful">3.1 restfulè§„èŒƒ</h3>
<table>
<thead>
<tr>
<th style="text-align: left;">GET</th>
<th style="text-align: left;">/students</th>
<th style="text-align: left;">è·å–æ‰€æœ‰å­¦ç”Ÿ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">è¯·æ±‚æ–¹æ³•</td>
<td style="text-align: left;">è¯·æ±‚åœ°å€</td>
<td style="text-align: left;">åç«¯æ“ä½œ</td>
</tr>
<tr>
<td style="text-align: left;">POST</td>
<td style="text-align: left;">/students</td>
<td style="text-align: left;">å¢åŠ å­¦ç”Ÿ</td>
</tr>
<tr>
<td style="text-align: left;">GET</td>
<td style="text-align: left;">/students/</td>
<td style="text-align: left;">è·å–ç¼–å·ä¸ºpkçš„å­¦ç”Ÿ</td>
</tr>
<tr>
<td style="text-align: left;">PUT</td>
<td style="text-align: left;">/students/</td>
<td style="text-align: left;">ä¿®æ”¹ç¼–å·ä¸ºpkçš„å­¦ç”Ÿ</td>
</tr>
<tr>
<td style="text-align: left;">DELETE</td>
<td style="text-align: left;">/students/</td>
<td style="text-align: left;">åˆ é™¤ç¼–å·ä¸ºpkçš„å­¦ç”Ÿ</td>
</tr>
</tbody>
</table>
<p>restfulè§„èŒƒæ˜¯ä¸€ç§é€šç”¨çš„è§„èŒƒï¼Œä¸é™åˆ¶è¯­è¨€å’Œå¼€å‘æ¡†æ¶çš„ä½¿ç”¨ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»ä½•ä¸€é—¨è¯­è¨€ï¼Œä»»ä½•ä¸€ä¸ªæ¡†æ¶éƒ½å¯ä»¥å®ç°ç¬¦åˆrestfulè§„èŒƒçš„APIæ¥å£ã€‚</p>
<p>å‚è€ƒæ–‡æ¡£ï¼šhttp://www.runoob.com/w3cnote/restful-architecture.html</p>
<h3 id="32">3.2 å¹‚ç­‰æ€§</h3>
<p>æ¥å£å®ç°è¿‡ç¨‹ä¸­ï¼Œä¼šå­˜åœ¨<strong>å¹‚ç­‰æ€§</strong>ã€‚æ‰€è°“å¹‚ç­‰æ€§æ˜¯æŒ‡ä»£<strong>å®¢æˆ·ç«¯å‘èµ·å¤šæ¬¡åŒæ ·è¯·æ±‚æ—¶ï¼Œæ˜¯å¦å¯¹äºæœåŠ¡ç«¯é‡Œé¢çš„èµ„æºäº§ç”Ÿä¸åŒç»“æœ</strong>ã€‚å¦‚æœ<strong>å¤šæ¬¡è¯·æ±‚</strong>ï¼ŒæœåŠ¡ç«¯<strong>ç»“æœ</strong>è¿˜æ˜¯<strong>ä¸€æ ·</strong>ï¼Œåˆ™å±äº<strong>å¹‚ç­‰æ¥å£</strong>ï¼Œå¦‚æœå¤šæ¬¡è¯·æ±‚ï¼ŒæœåŠ¡ç«¯äº§ç”Ÿç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼Œåˆ™å±äº<strong>éå¹‚ç­‰æ¥å£</strong>ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align: left;">è¯·æ±‚æ–¹å¼</th>
<th style="text-align: left;">æ˜¯å¦å¹‚ç­‰</th>
<th style="text-align: left;">æ˜¯å¦å®‰å…¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">GET</td>
<td style="text-align: left;">å¹‚ç­‰</td>
<td style="text-align: left;">å®‰å…¨</td>
</tr>
<tr>
<td style="text-align: left;">POST</td>
<td style="text-align: left;">ä¸å¹‚ç­‰</td>
<td style="text-align: left;">ä¸å®‰å…¨</td>
</tr>
<tr>
<td style="text-align: left;">PUT/PATCH</td>
<td style="text-align: left;">å¹‚ç­‰</td>
<td style="text-align: left;">ä¸å®‰å…¨</td>
</tr>
<tr>
<td style="text-align: left;">DELETE</td>
<td style="text-align: left;">å¹‚ç­‰</td>
<td style="text-align: left;">ä¸å®‰å…¨</td>
</tr>
</tbody>
</table>
<h3 id="33">3.3 åºåˆ—åŒ–</h3>
<p>apiæ¥å£å¼€å‘ï¼Œæœ€æ ¸å¿ƒæœ€å¸¸è§çš„ä¸€ä¸ªä»£ç ç¼–å†™è¿‡ç¨‹å°±æ˜¯åºåˆ—åŒ–ï¼Œæ‰€è°“åºåˆ—åŒ–å°±æ˜¯æŠŠ<strong>æ•°æ®è½¬æ¢æ ¼å¼</strong>ã€‚</p>
<p>å¸¸è§çš„åºåˆ—åŒ–æ–¹å¼ï¼šjsonï¼Œpickleï¼Œbase64ï¼Œâ€¦.</p>
<p>åºåˆ—åŒ–å¯ä»¥åˆ†ä¸¤ä¸ªé˜¶æ®µï¼š</p>
<p>â€‹   <strong>åºåˆ—åŒ–</strong>ï¼š æŠŠæˆ‘ä»¬è¯†åˆ«çš„æ•°æ®è½¬æ¢æˆæŒ‡å®šçš„æ ¼å¼æä¾›ç»™åˆ«äººã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬åœ¨djangoä¸­è·å–åˆ°çš„æ•°æ®é»˜è®¤æ˜¯æ¨¡å‹å¯¹è±¡ï¼Œä½†æ˜¯æ¨¡å‹å¯¹è±¡æ•°æ®æ— æ³•ç›´æ¥æä¾›ç»™å‰ç«¯æˆ–åˆ«çš„å¹³å°ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠæ•°æ®è¿›è¡Œåºåˆ—åŒ–ï¼Œå˜æˆå­—ç¬¦ä¸²æˆ–è€…jsonæ•°æ®ï¼Œæä¾›ç»™åˆ«äººã€‚</p>
<p>â€‹   <strong>ååºåˆ—åŒ–</strong>ï¼šæŠŠåˆ«äººæä¾›çš„æ•°æ®è½¬æ¢/è¿˜åŸæˆæˆ‘ä»¬éœ€è¦çš„æ ¼å¼ã€‚ä¾‹å¦‚ï¼šå‰ç«¯jsæä¾›è¿‡æ¥çš„jsonæ•°æ®ï¼Œå¯¹äºpythonè€Œè¨€jsonå°±æ˜¯å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œååºåˆ—åŒ–æ¢æˆå­—å…¸ï¼Œç„¶åæ¥ç€å­—å…¸å†è¿›è¡Œè½¬æ¢æˆæ¨¡å‹å¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½æŠŠæ•°æ®ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚</p>
<p><img alt="image-20210826145519130" src="image-20210826145519130-16318493451108.png" /> </p>
<h1 id="fastapi">å…«ã€FastAPIè¯·æ±‚æ¥å£</h1>
<h2 id="1_2">1 æ”¯æŒçš„è¯·æ±‚æ–¹å¼</h2>
<pre><code class="language-python">@app.get()
@app.post()
@app.put()
@app.patch()
@app.delete()
@app.options()
@app.head()
@app.trace()
</code></pre>
<h2 id="2_1">2 è·¯å¾„å‚æ•°</h2>
<pre><code class="language-python">@app.post(
    &quot;/items/{item_id}&quot;,
    response_model=Item,
    status_code=status.HTTP_200_OK,
    tags=[&quot;AAA&quot;],
    summary=&quot;this is summary&quot;,
    description=&quot;this is description&quot;,
    response_description= &quot;this is response_description&quot;,
    deprecated=False,
)
</code></pre>
<h2 id="3-include_router">3 è·¯ç”±ç»„(include_router)</h2>
<ul>
<li>main.py</li>
</ul>
<pre><code class="language-python">from typing import Union

from fastapi import FastAPI
import uvicorn

from apps import app01, app02

app = FastAPI()

app.include_router(app01, prefix=&quot;/app01&quot;, tags=[&quot;ç¬¬ä¸€ç« èŠ‚ï¼šå•†åŸæ¥å£&quot;, ])
app.include_router(app02, prefix=&quot;/app02&quot;, tags=[&quot;ç¬¬äºŒç« èŠ‚ï¼šç”¨æˆ·ä¸­å¿ƒæ¥å£&quot;, ])

if __name__ == '__main__':
    uvicorn.run(&quot;main:app&quot;, host=&quot;127.0.0.1&quot;, port=8080, debug=True, reload=True)
</code></pre>
<ul>
<li>app01..py</li>
</ul>
<pre><code class="language-python">from fastapi import APIRouter

app01 = APIRouter()

@app01.get(&quot;/shop/food&quot;)
def shop_food():
    return {&quot;shop&quot;: &quot;food&quot;}

@app01.get(&quot;/shop/bed&quot;)
def shop_food():
    return {&quot;shop&quot;: &quot;bed&quot;}
</code></pre>
<ul>
<li>app02..py</li>
</ul>
<pre><code class="language-python">from fastapi import APIRouter

app02 = APIRouter()

@app02.post(&quot;/user/login&quot;)
def user_login():
    return {&quot;user&quot;: &quot;login&quot;}

@app02.post(&quot;/user/reg&quot;)
def user_reg():
    return {&quot;user&quot;: &quot;reg&quot;}
</code></pre>
<h1 id="app">ä¹ã€å·¥å‚å‡½æ•°åˆ›å»ºapp</h1>
<ul>
<li>main.py</li>
</ul>
<pre><code class="language-python"># _*_ coding: utf-8 _*_

&quot;&quot;&quot;
æœåŠ¡å¯åŠ¨å‘½ä»¤ï¼šuvicorn main:app --reload
&quot;&quot;&quot;
import uvicorn  # noqa
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware

from app.api.v1 import index, project, version, file
from app.core.config import settings
from app.core.http_client import lifespan


def create_app() -&gt; FastAPI:
    &quot;&quot;&quot;
    åˆ›å»º FastAPI åº”ç”¨å®ä¾‹
    &quot;&quot;&quot;
    app = FastAPI(
        title=settings.PROJECT_NAME,
        version=&quot;1.0.0&quot;,
        description=&quot;FastAPI æ¨¡å—åŒ–é¡¹ç›®ç¤ºä¾‹&quot;,
        lifespan=lifespan
    )

    # æ³¨å†Œè·¯ç”± -è·¯ç”±ç»„é…ç½®
    routers = {
        &quot;/home&quot;: [
            (index.router, {&quot;tags&quot;: [&quot;é¦–é¡µ&quot;]})
        ],
        &quot;/api/v1&quot;: [
            (project.router, {&quot;tags&quot;: [&quot;é¡¹ç›®ç®¡ç†&quot;]}),
            (version.router, {&quot;tags&quot;: [&quot;ç‰ˆæœ¬ç®¡ç†&quot;]}),
            (file.router, {&quot;tags&quot;: [&quot;æ–‡ä»¶ç®¡ç†&quot;]}),
        ],
        # &quot;/api/v2&quot;:[]
    }
    for prefix, config in routers.items():
        for router, tags in config:
            app.include_router(router, prefix=prefix, tags=tags)

    # å…è®¸å¤šä¸ªæº
    origins = [
        &quot;http://localhost:9008&quot;,
    ]

    app.add_middleware(
        CORSMiddleware,
        allow_origins=origins,
        allow_credentials=True,
        allow_methods=[&quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;],
        allow_headers=[&quot;*&quot;],
    )

    return app


app = create_app()

if __name__ == '__main__':
    host = &quot;0.0.0.0&quot;
    port = 9777
    print(f&quot;æ–‡æ¡£åœ°å€ï¼šhttp://127.0.0.1:{port}/docs&quot;)
    print(f&quot;é¦–é¡µåœ°å€ï¼šhttp://127.0.0.1:{port}/home/index/&quot;)
    uvicorn.run(&quot;main:app&quot;, host=host, port=9777, log_level=&quot;debug&quot;)

</code></pre>
<h1 id="_4">åã€è·¯å¾„å‚æ•°</h1>
<ul>
<li>éœ€è¦ä½¿ç”¨æ‹¬å·ï¼š{} å°†å˜é‡åŒ…è£¹èµ·æ¥</li>
</ul>
<pre><code class="language-python"># _*_ coding: utf-8 _*_
from fastapi import APIRouter

router = APIRouter(prefix=&quot;/user&quot;)


@router.get(&quot;/1&quot;)  # æœ‰çš„åœºæ™¯å¯èƒ½éœ€è¦ï¼šä¸ªåˆ«è·¯ç”±ä¼˜å…ˆçº§ &gt; è·¯å¾„å‚æ•°è·¯ç”±ï¼Œæ­¤æ—¶éœ€è¦å†™åœ¨å‰é¢æ‰ä¼šä¼˜å…ˆåŒ¹é…
def get_user_info():
    &quot;&quot;&quot;è·å–ç”¨æˆ·ä¿¡æ¯&quot;&quot;&quot;
    return {&quot;id&quot;: 1}


@router.get(&quot;/{id}&quot;)
def get_user_info(id: int):  # åŒåå˜é‡ï¼Œä¸”æ³¨è§£ä¸ºintç±»å‹ï¼Œä¼šè‡ªåŠ¨è½¬ä¸ºintç±»å‹
    &quot;&quot;&quot;è·å–ç”¨æˆ·ä¿¡æ¯&quot;&quot;&quot;
    return {&quot;id&quot;: id, &quot;name&quot;: &quot;å¼ ä¸‰&quot;, &quot;age&quot;: 25}

</code></pre>
<ul>
<li>å·¥å‚å‡½æ•°éœ€è¦æ³¨å†Œå¯¹åº”çš„è·¯ç”±åˆ†å‘å®ä¾‹</li>
</ul>
<pre><code class="language-python"># æ³¨å†Œè·¯ç”± -è·¯ç”±ç»„é…ç½®
routers = {
    &quot;/home&quot;: [
        (index.router, {&quot;tags&quot;: [&quot;é¦–é¡µ&quot;]})
    ],
    &quot;/api/v1&quot;: [
        (project.router, {&quot;tags&quot;: [&quot;é¡¹ç›®ç®¡ç†&quot;]}),
        (version.router, {&quot;tags&quot;: [&quot;ç‰ˆæœ¬ç®¡ç†&quot;]}),
        (file.router, {&quot;tags&quot;: [&quot;æ–‡ä»¶ç®¡ç†&quot;]}),
        (user.router, {&quot;tags&quot;: [&quot;ç”¨æˆ·ç®¡ç†&quot;]})  # æ–°å¢ç”¨æˆ·è·¯ç”±é…ç½®
    ],
    # &quot;/api/v2&quot;:[]
}
for prefix, config in routers.items():
    for router, tags in config:
        app.include_router(router, prefix=prefix, tags=tags)
</code></pre>
<h1 id="_5">åä¸€ã€å­—ç¬¦ä¸²æŸ¥è¯¢å‚æ•°</h1>
<h2 id="1_3">1 å‚æ•°å®šä¹‰</h2>
<p>å®šä¹‰æ¥å£å‡½æ•°æ—¶ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®è·¯å¾„å‚æ•°ï¼Œä½†åœ¨æ¥å£å‡½æ•°å®šä¹‰äº†å…¶ä»–å‚æ•°ï¼Œé‚£ä¹ˆå…¶ä»–å‚æ•°å°†ä¼šè‡ªåŠ¨è¯†åˆ«ä¸ºå­—ç¬¦ç©¿æŸ¥è¯¢å‚æ•°</p>
<pre><code class="language-python">from typing import Union, Optional  # noqa

from fastapi import APIRouter, Depends  # noqa


@router.get(&quot;/{id}&quot;)
def get_user_info(id: int, a: int, b: str, c: Union[int, None], d: Optional[int], e=None):
    &quot;&quot;&quot;è·å–ç”¨æˆ·ä¿¡æ¯&quot;&quot;&quot;
    print(id, type(id))
    print(a, type(a))
    print(b, type(b))
    print(c, type(c))
    print(d, type(d))
    print(e, type(e))
    data = {&quot;id&quot;: id, &quot;a&quot;: a, &quot;b&quot;: b, &quot;c&quot;: c, &quot;d&quot;: d, &quot;e&quot;: e}
    return data
</code></pre>
<ul>
<li>Unionï¼šå…·ä½“è”åˆç±»å‹ï¼ˆä¸å¯çœç•¥Noneç±»å‹ï¼‰</li>
<li>Optionalï¼šå¯çœç•¥Noneç±»å‹å¡«å†™ï¼Œè‡ªåŠ¨åŒ…å«</li>
</ul>
<h2 id="2-pydantic">2 ç»“åˆPydanticåŒ…å®šä¹‰</h2>
<pre><code class="language-python">from pydantic import BaseModel
from typing import Union, Optional


class UserInfoQuery(BaseModel):
    id: int
    a: int
    b: str
    c: Union[int, None] = None
    d: Optional[int] = None
    e: Optional[str] = None


@router.get(&quot;/{id}&quot;)
def get_user_info(query: UserInfoQuery):
    &quot;&quot;&quot;è·å–ç”¨æˆ·ä¿¡æ¯&quot;&quot;&quot;
    print(query.id, type(query.id))
    print(query.a, type(query.a))
    print(query.b, type(query.b))
    print(query.c, type(query.c))
    print(query.d, type(query.d))
    print(query.e, type(query.e))
    data = {
        &quot;id&quot;: query.id,
        &quot;a&quot;: query.a,
        &quot;b&quot;: query.b,
        &quot;c&quot;: query.c,
        &quot;d&quot;: query.d,
        &quot;e&quot;: query.e
    }
    return data

</code></pre>
<p>è¿™ç§æ–¹å¼å®šä¹‰æ¥å£ï¼Œé»˜è®¤å°±ä½¿ç”¨jsonæ ¼å¼æ¥æ”¶æ•°æ®ï¼š</p>
<p><img alt="image-20251028220030633" src="image-20251028220030633.png" /> </p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tabs", "search.highlight", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>